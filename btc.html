<!DOCTYPE html>
<html>
  <head>
    <title>BTC</title>
  </head>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
    }

    h1 {
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px auto;
    }

    th,
    td {
      padding: 10px;
      border: 1px solid #ccc;
    }

    thead {
      background-color: #f2f2f2;
    }

    tbody tr:nth-child(even) {
      background-color: #f2f2f2;
    }
  </style>
  <body>
    <h1>Bitcoin Price & Amount Table</h1>

    <div class="mb-2 p-2 flex gap-2">
      <input
        type="text"
        id="searchInput"
        placeholder="Enter Amount"
        value="0"
        class="outline-none border border-gray-500 p-1 rounded"
      />
    </div>

    <table id="">
      <thead>
        <tr>
          <th>Time</th>
          <th>Price</th>
          <th>Amount</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <script>
      var exampleSocket = new WebSocket(
        "wss://stream.binance.com:9443/ws/btcusdt@trade"
      );

      exampleSocket.onmessage = function (event) {
        var amountAbove = document.getElementById("searchInput").value;

        var data = JSON.parse(event.data);

        const { T, p, q } = data;
        addToTable(T, p, q);
        // console.log(T, p, q);

        // var currentPrice = 0;
        // var amountAbove = 0;

        function addToTable(T, p, q) {
          newrPrice = parseFloat(p).toFixed(2);

          // var qty = q;

          // console.log(qty);

          const tableBody = document.getElementById("tableBody");
          const newRow = tableBody.insertRow(0);

          // if (qty > amountAbove) {
          //   if (newrPrice >= 50) {
          //     traders = traders.slice(0, 50);
          //   }
          const timeCell = document.createElement("td");
          timeCell.textContent = seconds =
            Math.floor((T / 1000) % 60) + " Seconds ago";
          newRow.appendChild(timeCell);

          const priceCell = document.createElement("td");
          priceCell.textContent = newrPrice;
          newRow.appendChild(priceCell);

          const amountCell = document.createElement("td");
          amountCell.textContent = q;
          newRow.appendChild(amountCell);
          // }
          tableBody.appendChild(newRow);
        }
      };
    </script>
  </body>
</html>
